# Kombinatorika a grafy 1

## Odhady na kombinatorické funkce

- $n!=\prod_{i=1}^ni$
- lemma: $n^{n/2}\leq n!\leq n^n$
	- horní odhad jednoduchý
	- dolní odhad
		- součin prvního a posledního, druhého a předposledního, … prvku součinu faktoriálu je vždy $\geq n$
		- aby byl počet činitelů faktoriálu sudý, použijeme $(n!)^2$
		- takže $(n!)^2=\prod_{i=1}^n(i\cdot(n+1-i))\geq n^n$
		- proto $n!\geq n^{n/2}$
		- to, že $i(n+1-i)\geq n$, lze dokázat graficky pomocí funkce $f(x)=x(n+1-x)$
	- důsledek $\sqrt n\leq \sqrt[n]{n!}\leq n$
	- $\sqrt[n]{n!}$ se chová trochu jako $\frac n2$
- věta: $e(\frac ne)^n\leq n!\leq en(\frac ne)^n$
	- u zkoušky můžeme použít libovolný korektní důkaz (obecně u všech vět)
	- důkaz 1: indukcí s využitím $e^x\geq 1+x$
	- důkaz 2: odhad pomocí integrálu $\ln(n!)=\sum_{i=1}^n\ln(i)=\sum_{i=2}^n\ln(i)$
		- schodovitá plocha, kde schod má šířku 1 a výšku $\ln(i)$ má obsah daný uvedeným součtem
		- obsah schodovité plochy je zdola odhadnutý obsahem plochy pod křivkou logaritmu
		- $\ln(n!)\geq\int_1^n\ln(x)\,dx=[x\ln(x)-x]^n_1=(n\ln n-n+1)=:I_n$
		- $n!\geq e^{I_n}=e^{n\ln n-n+1}=e(\frac ne)^n$
		- obdobně dolní odhad
			- $\ln((n-1)!)\leq I_n$
			- $e^{I_n}\geq(n-1)!\implies n\cdot e^{I_n}\geq n!\implies n\cdot e(\frac ne)^n\geq n!$
	- důkaz 3: jen $(\frac ne)^n\leq n!$
		- víme z analýzy, že $e^x=1+x+\frac{x^2}{2}+\frac{x^3}{3!}+\dots+\frac{x^k}{k!}+\dots=\sum^\infty_{k=0}\frac{x^k}{k!}$
		- pro $x\geq 0:e^x\geq\frac {x^n}{n!}$ (protože Taylorova řada určitě někde obsahuje $x^n\over n!$)
		- tedy $n!\geq \frac{x^n}{e^x}\implies n!\geq \frac{n^n}{e^n}=(\frac ne)^n$ (platí to pro libovolné $x\geq 0$, takže dosadíme $x=n$)
- kombinační číslo ${n\choose k}=\frac{n!}{k!(n-k)!}=\frac{n\cdot(n-1)\cdots(n-k+1)}{k\cdot(k+1)\cdots1}$
	- jeho odhad…
- pozorování: ${n\choose k}={n\choose n-k}$
- ${2m\choose m}$
- fakt: kombinační čísla v jednom řádku Pascalova trojúhelníku zleva doprava do poloviny rostou, od poloviny klesají
- fakt: $\sum_{k=0}^n{n\choose k}=2^n=(1+1)^n$
- pozorování: $\frac{2^{2m}}{2m+1}\leq{2m\choose m}\leq 2^{2m}$
- věta: $\forall m\in\mathbb N:\frac{2^{2m}}{2\sqrt{m}}\leq {2m\choose m}\leq {2^{2m}\over\sqrt{2m}}$
- důkaz
	- definujme $P:=\frac{2m\choose m}{2^{2m}}$ a dokažme $\frac1{2\sqrt{m}}\leq P\leq \frac{1}{\sqrt{2m}}$
	- …

## Vytvořující (generující) funkce

- definice: vytvořující funkce posloupnosti $(a_n)_{n=0}^\infty$ reálných čísel je funkce proměnné $x$ definovaná jako součet $f(x)=\sum_{n=0}^\infty a_n(x^n)$
	- tato funkce nemusí být dobře definovaná pro všechna reálná čísla (dokonce se může stát, že nebude definovaná pro žádné reálné číslo kromě nuly)
	- pro nás bude praktické, když bude definovaná na okolí nuly (více než jednobodovém)
- fakt: pokud existuje $K\gt 0$ taková, že $\forall n:|a_n|\leq K^n$ (posloupnost se dá shora odhadnout nějakou exponenciální funkcí), tak řada $\sum_{n=0}^\infty a_nx^n$ konverguje na $(-\frac 1K,\frac 1K)$ absolutně stejnoměrně
- navíc má $f(x)=\sum_{n=0}^\infty a_nx^n$ derivace všech řádů na $(-\frac 1K,\frac 1K)$, které se dají spočítat „derivováním člen po členu“
	- $f'(x)=\sum_{n=0}^\infty a_nnx^{n-1}$
	- $f''(x)=\sum_{n=0}^\infty a_nn(n-1)x^{n-2}$
	- $f(x)=a_0+a_1x+a_2x^2+a_3x^3+\dots$
	- $f'(x)=a_1+2a_2x+3a_3x^2+\dots$
	- $f''(x)=2a_2+3\cdot 2a_3+\dots$
	- $f^{(n)}(x)=n!\cdot a_n+\dots$
- důsledek
	- $f(0)=a_0$
	- $f'(0)=a_1$
	- $f''(0)=2a_2$
	- $f^{(n)}(0)=n!\cdot a_n$
	- takže $a_n=\frac{1}{n!} f^{(n)}(0)$
- fakt: vytvořující funkce lze mezi sebou násobit jako polynomy, výsledek je vytvořující funkcí posloupnosti $a_0b_0,a_0b1+a_1b0,\dots$, této posloupnosti se říká konvoluce posloupností $(a_n)_{n=0}^\infty$ a $(b_n)_{n=0}^\infty$
- užití vytvořujících funkcí
	- kombinatorické počítání
	- asymptotické odhady
	- dokazování identit u posloupností
	- řešení rekurencí
- příklad na kombinatorické počítání – platíme $n$ Kč pomocí mincí s hodnotami 1, 2 a 5 Kč, na pořadí nezáleží ($a_n$ je počet způsobů, jak $n$ korun zaplatit)
	- $f(x)=\sum_{n=0}^\infty a_nx^n=$
	- $=(1+x+x^2+x^3+\dots)(1+x^2+x^4+x^6+\dots)(1+x^5+x^{10}+\dots)$
	- $=\frac1{1-x}\cdot\frac1{1-x^2}\cdot\frac1{1-x^5}$
	- pak lze zjistit koeficient u $x^n$, ten se bude rovnat $a_n$

### Řešení rekurencí

- Fibonacciho čísla $F_0:=0,\,F_1:=1,\,F_n:=F_{n-1}+F_{n-2}$ pro $n\geq 2$
	- chceme získat explicietní vzorec pro $f(x)=\sum_{n=0}^\infty F_nx^n$
	- obecná metoda řešení rekurencí
		- vezmi rekurenci pro $n\geq n_0$
		- vynásob ji $x^n$
		- sečti pro $n\geq n_0$
		- vyjádři všechny sumy pomocí hledané vytvořující funkce $f(x)$
		- dopočítej $f(x)$
	- aplikace na $F_n$
		- $F_n=F_{n-1}+F_{n-2}$ pro $n\geq 2$
		- $F_nx^n=F_{n-1}x^n+F_{n-2}x^n$ pro $n\geq 2$
		- $\underbrace{\sum_{n=2}^\infty F_nx^n}_{S_1}=\underbrace{\sum_{n=2}^\infty F_{n-1}x^n}_{S_2}+\underbrace{\sum_{n=2}^\infty F_{n-2}x^n}_{S_3}$
			- $S_1=F_2x^2+F_3x^3+F_4x^4+\dots=f(x)-F_0-F_1x$
			- $S_2=F_1x^2+F_2x^3+F_3x^4+\dots=x(f(x)-F_0)$
			- $S_3=F_0x^2+F_1x^3+F_2x^4+\dots=x^2f(x)$
			- $S_1=S_2+S_3$
			- $f(x)-F_0-F_1x=x(f(x)-F_0)+x^2f(x)$
			- $f(x)-xf(x)-x^2f(x)=F_0+F_1x-F_0x$
			- $f(x)\cdot(1-x-x^2)=F_0+F_1x-F_0x$
			- $f(x)=\frac{F_0+F_1x-F_0x}{1-x-x^2}=\frac x{1-x-x^2}$
- obecnější příklad – mějme posloupnost $a_0,a_1,a_2,\dots$, která splňuje $a_n=\alpha_1a_{n-1}+\alpha_2a_{n-2}+\dots+\alpha_da_{n-d}$ pro každé $n\geq d$, kde $d\in\mathbb N$, $\alpha_1,\dots,\alpha_d\in\mathbb R,\,\alpha_d\neq 0$; najďeme vzorec pro $f(x)=\sum_{n=0}^\infty a_nx^n$
	- $\sum_{n=d}^\infty a_nx^n=$
	- $=\sum_{n=d}^\infty\alpha_1a_{n-1}x^n+\sum_{n=d}^\infty\alpha_2a_{n-2}x^n+\dots+\sum_{n=d}^\infty\alpha_da_{n-d}x^n$
	- $f(x)-(a_0+a_1x+\dots+a_{d-1}x^{d-1})=$
	- $=a_1x(f(x)-(a_0+a_1x+\dots+a_{d-2}x^{d-2}))+$
	- $+a_2x^2(f(x)-(a_0+\dots+a_{d-3}x^{d-3}))+\dots+a_dx^df(x)$
	- …
- pro $\alpha,\beta,\gamma\in\mathbb R,\,\beta\neq0:\frac\alpha{\beta+\gamma x}=\frac\alpha\beta\cdot\frac1{1-(-\frac\gamma\beta x)}$
	- z toho už umím najít původní vzorec vytvořující funkce pomocí $\frac1{1-x}$
- víme: binomická věta
	- pro $d\in\mathbb N_0:(1+x)^d=\sum_{n=0}^d{d\choose n}x^n$
	- tedy $(1+x)^d$ je vytvořující funkcí pro ${d\choose 0},{d\choose1},{d\choose2},\dots,{d\choose d},0,0,0,\dots$
- df: pro $\delta\in\mathbb R$ a $n\in\mathbb N_0$ definujeme zobecněné kombinační číslo ${\delta\choose n}:=\frac{\delta(\delta-1)\cdot(\delta-2)\cdot\ldots\cdot(\delta-n+1)}{n!}$
- věta: zobecněná binomická věta
	- pro $\delta\in\mathbb R$ platí $(1+x)^\delta=\sum_{n=0}^\infty{\delta\choose n}x^n$
	- nekonečno bychom mohli použít i u základní binomické věty, pokud bychom použili zobecněné kombinační číslo
	- celkově ignorujeme otázky konvergence, ale aby věta platila, tak bychom chtěli $|x|\lt1$
- dk: označme $f(x)=(1+x)^\delta$
	- vidíme
		- $f'(x)=\delta(1+x)^{\delta-1}$
		- $f''(x)=\delta(\delta-1)(1+x)^{\delta-2}$
		- $\quad\vdots$
		- $f^{(n)}(x)=\delta(\delta-1)\cdot\ldots\cdot(\delta-n+1)(1+x)^{\delta-n}$
		- $\quad\vdots$
	- nechť $a_0,a_1,\dots$ je posloupnost s vytvořující funkcí $f(x)$
	- potom $a_n=\frac{f^{(n)}(0)}{n!}={\delta\choose n}\quad\square$
- důsledek
	- pro $d\in\mathbb N_0:\frac1{(1-x)^d}=(1+(-x))^{-d}=_{\text{ZBV}}$
	- …
- 