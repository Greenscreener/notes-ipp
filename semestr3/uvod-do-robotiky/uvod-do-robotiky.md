# Úvod do robotiky

- zkouška ústní podle sylabu
	- nejdřív musíme mít odevzdané a opravené všechny teoretické domácí úkoly
- zápočet za docházku, domácí úkoly a finální projekt
	- dvě absence jsou povoleny (víc radši ne)
	- domácí úkoly
		- do SISu
		- první verzi nejpozději den před příštím cvičením (odevzdat aspoň pokus o řešení)
		- na cvičeních se proberou nejčastější špatná řešení (ale můžeme se i doptat na to svoje konkrétní)
		- pak nahrát opravnou verzi (dříve než se přihlásím ke zkoušce; do SISu se odevzdává jako correction)
		- u zkoušky bych měl být schopen všechny své úkoly obhájit
		- pokud se v SISu u mého řešení objeví OK $\implies$ úkol je v pořádku (platí pouze tato jediná implikace, o kontrolu našeho řešení můžeme výslovně požádat po cvičení)
		- v první fázi teoretické úkoly, pak práce s roboty
	- závěrečný projekt předvést do konce zkouškového v zimním semestru
	- na výjimkách je potřeba se domluvit předem
- Parallax BoeBot
- programuje se v C++
- první úkol  
	- přečíst Runaround  
	- vymyslet ke každému zákonu výjimku (tenhle zákon tvrdí tohle, ale bylo by dobré, kdyby ho v této situaci robot porušil)  
	- stačí TXT, nahrát do SISu  
	- uvažovat robota s limity a omezenými informacemi  
	- zákon je formulovaný slovně, můžeme v úkolu popsat, jak ty věci chápeme  
	- nemusí to být extra dlouhé, máme se zamyslet a popsat nějakou myšlenku

## Kinematika

- póza = poloha + orientace
	- ale občas se póza zaměňuje s polohou
	- typicky nás zajímá stav robota, tzn. poloha, orientace, stav nabití baterie, …
- dopředná úloha kinematiky – víme, o kolik jsme pohli manipulátorem, zajímá nás, kam se dostal
- zpětná úloha kinematiky – víme, kam se chceme dostat, zajímá nás, jak to uděláme
- kinematika = pohyb jednotlivých částí robota bez vztahu k silám
- obvykle nás zajímá ještě dynamika
- dopředná úloha kinematiky je vlastně násobení transformačních matic
- ve zpětné úloze kinematiky počítáme úhly pomocí původních a cílových souřadnic
- stupně volnosti
	- stupeň volnosti = počet nezávislých proměnných v systému
	- často se mluví o stupni volnosti v prostoru
		- na přímce 2 (pohyb, dopředu/dozadu)
		- v rovině 3 (pohyb, dopředu/dozadu, natočení)
	- ve 2D
		- 3 stupně volnosti (DOF = Degrees of Freedom)
		- kartézská soustava souřadnic $[x,y,\alpha]$
	- ve 3D
		- 6 stupňů volnosti
		- $[x,y,z,\alpha,\beta,\gamma]$
		- někdy se jeden úhel nepočítá vůči rovině, ale vůči ose otáčení daného nástroje (např. šroubováku)
		- natočení
			- podle $x$ = roll, náklon
			- podle $y$ = pitch, sklon, zdvih, sklopení
			- podle $z$ = yaw, otočení, směr (to není úplně vhodné označení)
		- používáme pravotočivý systém (pravou rukou, prsty ukazují směrem $x$, zavřením dlaně je otočím k ose $y$, palec ukazuje směr osy $z$)
		- kladný směr otáčení je proti směru hodinových ručiček
- manipulátor vs. robot
	- manipulátor – je připraven pro vykonávání dané operace
	- robot – je snadno přeprogramovatelný
- manipulátor
	- stav jednoho kloubu popisuje jedna proměnná (joint variable $q_i$)
		- může být vícesložková
	- stavový vektor (joints state) $q=[q_1,q_2,\dots,q_n]$
		- $n$ stupňů volnosti
	- pracovní prostor (working space) – kartézský součin všech proměnných
	- lokální vs. globální souřadný systém (local × global coordinate system – LCS, GCS)
		- lokální systém je někdy výhodnější – pokud se něco změní u jednoho kloubu, stačí to softwarově změnit pouze u něj
		- typicky nás zajímají globální souřadnice
	- typy kloubů
		- otočný (revolute) – 1 stupeň volnosti
		- prismatický = píst (prismatic) – 1 stupeň volnosti
		- šroub (helical) – 1 stupeň volnosti
		- cylindrical – 2 stupně volnosti
		- spherical – 3 stupně volnosti (pohyb kolem dvou os + otáčení)
		- planar – 3 stupně volnosti (posun ve dvou osách + otáčení)
	- obvykle se používají prismatický a otočný
	- poloha … stavový vektor o tolika složkách, kolik jich potřebujeme
	- rotace
		- $P$ … poloha
		- $R$ … rotační matice
		- $P'=R\cdot P$
		- $R_{x,\phi}=\begin{bmatrix}1&0&0\\0&\cos\phi&-\sin\phi\\0&\sin\phi&\cos\phi\end{bmatrix}$
			- rotace podle osy $x$
		- používáme písmenka fí $\phi$, psí $\psi$, xí $\xi$
	- rotace a translace
		- $P'=R\cdot P+T$
		- místo $T$ (translation) se někdy píše $D$ jako displacement
	- jak to kombinovat?
		- $P'=R_2\cdot(R\cdot P+T)+T_2$
		- …
	- homogenní souřadnice ve 2D
		- bod vyjádřím jako $p=(x,y,w)^T$
		- kde $w$ je projekce do nějaké roviny
		- budeme pracovat s $w=1$
		- rotace v rovině vypadá stejně jako rotace podle osy $z$ v prostoru (takže u třetí souřadnice bude identita)
		- translaci $p'=p+\mathcal D_p$ uděláme pomocí násobení matic
		- $(x',y',w')^T=\begin{pmatrix}1&0&d_x\\0&1&d_y\\0&0&1\end{pmatrix}\cdot\begin{pmatrix}x\\ y\\ w\end{pmatrix}$
	- dopředná kinematika ve 3D
		- $P=f(q)$
		- $q=[q_1,q_2,\dots,q_6]$
		- $P=[x,y,z,\alpha,\beta,\gamma]$
	- složení systému
		- obecné
			- každý kloub je reprezentován svou geometrickou transformací
			- přechod mezi lokálními souřadnicovými systémy
			- může být těžké vytvořit celkovou zkombinovanou transformační matici
		- Denavit-Hartenberg
			- pokud jsou systémy šikovně navrženy
			- funguje ve 3D
			- fiktivní pohyby spojující dva systémy – rotate (podle osy $z$), move (po ose $z$), move (po ose $x$), rotate (podle osy $x$)
			- v libovolně dlouhé sekvenci
- Denavit-Hartenberg (DH) systém
	- systém je složen z rotačních a posuvných kloubů, mezi klouby jsou spoje
	- vztah mezi $LCS_{i-1}$ a $LCS_i$ je složená trasformace
		- natočení osy $x_{i-1}$ kolem osy $z_{i-1}$ o úhel $\vartheta_i$
		- posunutí osy $x_{i-1}$ ve směru osy $z_{i-1}$ o vzdálenost $d_i$
		- posunutí počátku $LCS_{i-1}$ podél osy $x_i$ o vzdálenost $a_i$
		- natočení osy $z_{i-1}$ kolem osy $x_i$ o úhel $\alpha_i$
	- DH parametry $\vartheta_i,d_i,a_i,\alpha_i$
		- $\vartheta_i$ … úhel mezi osami $x$ kolem $z_{i-1}$
		- $d_i$ … vzdálenost mezi osami $x$
		- $a_i$ … vzdálenost mezi osami $z$
		- $\alpha_i$ … úhel mezi
	- osy $z$ jsou dány tím, jak to kdo vyrobil
	- osu $x$ si zvolím tak, aby byla kolmá na $z_i$ a $z_{i-1}$
	- $\vartheta_i$ a $d_i$ jsou proměnné, zbytek jsou konstanty (?)
	- konstrukce D-H řetězce
		- očíslování kloubů $0$ až $n$ ($0$ je první, pevný)
		- očíslování článků $1$ až $n$ (článek $i$ spojuje klouby $i-1$ a $i$)
		- používáme ortonormální pravotočivý souřadný systém
		- …
	- někdy je potřeba přeznačit osy – v takové situaci bude jeden řádek tabulky bez proměnné

## Mobilní zařízení (motion model)

- holonomní / neholonomní vozidla
- Heinrich Hertz – stupně volnosti
	- vozidlo je holonomní, pokud se počet lokálních stupňů volnosti rovná počtu globálních stupňů volnosti
	- opak = přezadaný systém, v reálném světě se některá kola smýkají
- vlak … holonomní (v 1D prostoru jezdí dopředu a dozadu)
- auto … neholonomní (v 2D prostoru jezdí dopředu a dozadu, otáčí kola, ale nemůže jet do boku)
- pokud chceme najít výslednou polohu, integrujeme přes čas
- Ackermannovo řízení
	- neholonomní
	- natáčím jednu soupravu (jako u auta)
	- v zatáčce je potřeba, aby vnitřní kolo bylo natočeno jinak než vnější kolo (tzn. nelze natáčet přímo osu, na které jsou kola – v takovém případě se kola smýkají)
	- zatáčí se posouváním tyče rovnoběžné s přední osou, ta je ke kolům připojena tyčemi, jejichž prodloužení se protínají uprostřed zadní osy („delta“?)
	- v praxi se používá složitější konstrukce
- differential steering (diferenciální řízení?)
	- neholonomní
	- zatáčím rozdílem rychlosti levého a pravého kola (jako u tanku)
	- použití v praxi
		- obecnou trajektorii nahradím sérií úseček nebo oblouků
		- musím rozumně určit $\Delta t$ – ne moc malé, abych pořád nepočítal, ale ne moc velké, abych dostal rozumné výsledky (situace: obě kola ujely stejně, ale nejdřív jedno stálo a druhé se točilo a pak naopak)
		- musím změřit vzdálenost
- omnidirectional steering
	- holonomní
	- kola mohou jet libovolným směrem
	- příklady
		- swerve/crab drive – lze otáčet kolem o 360 stupňů
		- omniwheel – kolo má po obvodu válečky, které mohou volně prokluzovat ve směru kolmém na směr otáčení kola
		- mecanum wheel – velmi podobné jako omniwheel, ale válečky jsou otočeny o 45 stupňů; když točím kolem, tak výsledný pohyb směřuje šikmo (rovněž pod úhlem 45 stupňů)
		- …
		- syncrodrive – není úplně omnidirectional, všechny kola jsou natočeny stejným směrem
	- špatná prostupnost terénem
	- jednoduchá mechanická konstrukce pro omniwheels a mecanum wheels
